# 📚 그림으로 배우는 Http & Network Basic
## 📖 6장 HTTP 헤더 🔎

<br>

### 📍 1 HTTP의 약점

- 평문(암호화 하지 않은) 통신이기 때문에 도청 가능
- 통신 상대를 확인하지 않기 때문에 위장 가능
- 완전성을 증명할 수 없기 때문에 변조 가능

<br>

- 이 약점은 HTTP만이 아닌, 다른 암호화하지 않은 프로토콜에도 공통되는 문제이다. 

<br>

#### 📎 1.1 평문이기 때문에 도청 가능

<br>

- HTTP를 사용한 리퀘스트나 리스폰스 통신 내용은 HTTP 자신을 암호화하는 기능은 없기 때문에 통신 전체가 암호화 되지는 않는다. 
- 즉, 평문(암호화되지 않은 메시지)으로 HTTP 메시지를 보내게 된다. 

##### TCP/IP는 도청 가능한 네트워크

- 어째서 암호화되어 있지 않은 통신에 약점이 있냐 하면 TCP/IP의 구조의 통신 내용은 전부 통신의 경로의 도중에 엿볼 수 있기 때문이다. 
- 인터넷은 전 세계를 경유하는 네트워크로 되어 있다. 
- 어느 서버와 클라이언트가 통신을 할 때, 통신 경로 상에 있는 네트워크 기기나 케이블이나 컴퓨터 등을 전부 자기 자신이 소유하고 있는 일은 있을 수 없다. 그래서 악의를 가진 누군가가 엿볼 수 있다. 
- 통신 내용을 엿볼 수 있다는 것은, 암호화된 통신에서도 암호화되지 않은 통신도 같다. 
- 암호화 통신은 메시지 속의 의미는 간파할 수 없을 수도 있겠지만 암호화된 메시지 자체는 엿볼 수 있다. 

- 네트워크 상을 흐르고 있는 패킷을 수집하는 것만으로 도청할 수 있게 된다. 

##### 암호화로 도청을 피하다

1. 통신 암호화
- HTTP에는 암호화 구조는 없지만 `SSL(Secure Socket Layer)`이나 `TLS(Transport Layer Security)`이라는 다른 프로토콜을 조합함으로써 HTTP의 통신 내용을 암호화할 수 있다. 
- SSL 등을 이용해 안전한 통신로를 확립하고 나서 그 통신로를 사용해 HTTP 통신을 한다. 
- SSL을 조합한 HTTP를 HTTPS(HTTP Secure)나 HTTP over SSL이라 불리고 있다. 

2. 콘텐츠 암호화 
- 통신하고 있는 콘텐츠의 내용 자체를 암호화해 버리는 방법
- HTTP에 암호화를 하는 기능은 없기 때문에 HTTP를 사용해서 운반하는 내용을 암호화하는 것이다. 
- 즉, HTTP 메시지에 포함되는 콘텐츠만 암호화하는 것이다. 
- 클라이언트에서 HTTP 메시지를 암호화해서 출력하는 처리가 필요하게 된다. 
- 콘텐츠의 암호화를 유효하게 하기 위해서는 클라이언트와 서버가 콘텐트의 암호화나 복호화 구조를 가지고 있는 것이 전제가 되므로, 평상시에 유저가 사용하는 브라우저와 웹 서버에서는 이용하는 것은 어렵다. 주로 웹 서비스 등에서 이용되는 방법이다. 

<br>

#### 📎 1.2 통신 상대를 확인하지 않기 때문에 위장 가능

<br>

- HTTP를 사용한 리퀘스트나 리스폰스에서는 통신 상대를 확인하지 않는다. 
- 리퀘스트를 보낸 서버가 정말로 URI에서 지정된 호스트인지 아닌지, 리스폰스를 반환한 클라이언트가 정말로 리퀘스트를 출력한 클라이언트인지 아닌지를 모른다. 

<br>

##### 누구나 리퀘스트할 수 있다

- HTTP에 의한 통신에는 상대가 누구인지 확인하는 처리는 없기 때문에 누구든지 리퀘스트를 보낼 수 있다. 
- 리퀘스트가 오면 상대가 누구든지 무언가의 리스폰스를 반환한다. (단, IP 주소나 포트 등에서 그 웹 서버에 액세스 제한이 없는 경우)
- HTTP는 누구이던 간에 리퀘스트를 보내면 리스폰스가 반환되는 매우 심플한 구조로 되어 있지만, 상대를 확인하지 않는 점이 약점일 수가 있다. 
  - 리퀘스트를 보낸 곳의 웹 서버가 원래 의도한 리스폰스를 보내야 하는 웹 서버인지 아닌지를 확인할 수 없다. 위장한 웹 서버일 우려가 있다. 
  - 리스폰스를 반환한 곳의 클라이언트가 원래 의도한 리퀘스트를 보낸 클라이언트인지 아닌지를 확인할 수 없다. 위장한 클라이언트일 우려가 있다. 
  - 통신하고 있는 상대가 접근이 허가된 상대인지 아닌지를 확인할 수 없다. 중요한 정보를 가진 웹 서버에서는 특정 상대만 통신을 허가하고 싶을 때가 있다. 
  - 어디의 누가 리퀘스트를 했는지를 확인할 수 없다. 
  - 의미없는 리퀘스트라도 수신하게 된다. 대량의 리퀘스트에 의한 DoS 공격(서비스 불능 공격)을 방지할 수가 없다. 

<br>

##### 상대를 확인하는 증명서 
- HTTP에서는 통신 상대를 확인할 수 없지만 SSL로 상대를 확인할 수 있다. 
- SSL은 암호화뿐만 아니라 상대를 확인하는 수단으로 증명서를 제공하고 있다. 
- 통신 상대의 서버나 클라이언트가 가진 증명서를 확인함으로써 통신 상대가 내가 통신하고자 하는 상대인지 아닌지를 판단할 수 있다. 
- 신뢰할 수 있는 제3자란, 기본적으로 사회에서 인정된 기업이나 조직을 가리킨다. 
- 이 증명서를 이용함으로써, 통신 상대가 내가 통신하고자 하는 서버임을 나타내고 이용자는 개인 정보 누설 등의 위험성이 줄어들게 된다. 
- 또한, 클라이언트가 증명서를 가짐으로써 본인 확인을 하고, 웹 사이트 인증에서 이용할 수도 있다. 

<br>

#### 📎 1.3 완전성을 증명할 수 없기 때문에 변조 가능

<br>

- 완전성이란 정보의 정확성을 가리킨다. 
- 그것을 증명할 수 없다는 것은 정보가 정확한지 아닌지를 확인할 수 없음을 의미한다. 

<br>

##### 수신한 내용이 다를지도 모른다.

- HTTP가 완전성을 증명할 수 없다는 뜻은 만약 리퀘스트나 리스폰스가 발신된 후에 상대가 수신할 때까지의 사이에 변조되었다고 하더라도 이 사실을 알 수 없다는 뜻
- 즉, 발신된 리퀘스트나 리스폰스와 수신한 리퀘스트나 리스폰스가 같은지 아닌지를 확인할 수 없다는 의미이다. 
- 예를 들어, 어떤 웹 사이트에서 콘텐츠를 다운로드 했다고 하면 클라이언트에 다운로드한 파일과 서버 상에 있는 파일이 정말로 같은 것인지 아닌지 모른다는 것이다. 
- 이와 같이 공격자가 도중에 리퀘스트나 리스폰스를 빼앗아 변조하는 공격을 중간자 공격(Man-in-the-Middle 공격)이라고 부른다.

<br>

##### 변조를 방지하려면?

- HTTP를 사용해서 완전성을 확인하기 위한 방법은 있지만, 확실하면서 편리한 방법은 현재로서는 존재하지 않는다. 
- 그 중에서도 자주 사용되고 있는 방법은 MD5나 SHA-1 등의 해시 값을 확인하는 방법과 파일의 디지털 서명을 확인하는 방법이다. 
- 확실히 방지하기에는 HTTPS를 사용할 필요가 있다. 
- SSL에는 인증이나 암호화, 그리고 다이제스트 기능을 제공하고 있다. 
- HTTP만으로는 완전성을 보증하는 것이 어렵기 때문에 다른 프로토콜을 조합함으로써 실현하고 있다. 
