# 📖 1장 데이터 타입  ✏️

데이터에 관한 장으로, 자바스크립트가 데이터를 처리하는 과정을 살펴봄으로써 기본형 타입과 참조형 타입이 서로 다르게 동작하는 이유를 이해하고 이를 적절히 활용할 수 있게 되는 것을 목표 

<br>

***

<br>

## 01 데이터 타입의 종류

- 기본형(primitive type) : 숫자, 문자열, boolean, null, undefined, 심볼 등이 있다. 
  - 값이 담긴 주솟값을 바로 복제
  - 불변성을 띈다

<br>

- 참조형(reference type) : 객체, 배열, 함수, 날짜, 정규표현식 등과 ES6에서 추가된 Map, WeakMap, Set, WeakSet 등이 객체의 하위 분류에 속한다. 
  - 값이 담긴 주솟값들로 이루어진 묶음을 가리키는 주솟값을 복제 

## 02 데이터 타입에 관한 배경지식 

### 2-1 메모리와 데이터 

- 비트(bit) : 0 또는 1만 표현할 수 있는 하나의 메모리 조각을 비트라고 한다. 
- 메모리는 매우 많은 비트들로 구성돼 있는데, 각 비트는 고유한 식별자를 통해 위치를 확인할 수 있다. 
- 자주 사용하지 않을 데이터를 표현하기 위해 빈 공간을 남겨놓기보다는 표현 가능한 개수에 어느 정도 제약이 따르더라도 크게 문제가 되지 않을 적정한 공간을 묶는 편이 낫다. 
- 바이트(byte) : 8개의 비트로 구성돼 있다. 
  - 1바이트는 총 256개의 값을 표현할 수 있다. 

- 바이트 역시 시작하는 비트의 식별자로 위치를 파악할 수 있을 것이다. 
- 모든 데이터는 바이트 단위의 식별자, 더 정확하게는 **메모리 주솟값(memory address)**을 통해 서로 구분하고 연결할 수 있다. 

### 2-2 식별자와 변수

- **변수** : 변할 수 있는 수 
  -  `variable` 변할 수 있는 데이터(숫자, 문자열, 객체, 배열)
- **식별자** : 어떤 데이터를 식별하는 데 사용하는 이름, 즉 **변수명**이다. 

<br>

***

<br>

## 03 변수 선언과 데이터 할당

### 3-1 변수 선언 
- 변수란 결국 **변경 가능한 데이터가 담길 수 있는 공간 또는 그릇**

<br>

- 자바스크립트 데이터 구조 이해
  1. 컴퓨터는 메모리에서 비어있는 공간 하나를 확보
  2. 공간의 이름(식별자)을 `a`라고 지정
  3. 사용자가 `a`에 접근하고자 하면 컴퓨터는 메모리에서 `a`라는 이름을 가진 주소를 검색해 해당 공간에 담긴 데이터를 반환한다. 

### 3-2 데이터 할당

- 변수 영역에 값을 직접 대입하지 않고 굳이 번거롭게 한 단계를 더 거치는 걸까?
  - 데이터 변환을 자유롭게 할 수 있게 함과 동시에 메모리를 더욱 효율적으로 관리하기 위함 
    - 숫자형 데이터는 64비트(8바이트)의 공간을 확보
    - 문자열은 각각 필요한 메모리 용량이 가변적이며 전체 글자 수 역시 가변적
- 효율적으로 문자열 데이터의 변환을 처리하려면 변수와 데이터를 별도의 공간에 나누어 저장하는 것이 최적이다. 

- 기본 문자열에 어떤 변환을 가하든 상관 없이 무조건 새로 만들어 별도의 공간에 저장한다. 
- 변수 영역과 데이터 영역을 분리하면 중복된 데이터에 대한 처리 효율이 높아진다. 

## 04 기본형 데이터와 참조형 데이터
### 4-1 불변값
- 변수(variable)와 상수(constant)를 구분하는 성질은 **'변경가능성'**이다. 
- 바꿀 수 있으면 변수, 바꿀 수 없으면 상수이다. 
- 변수와 상수를 구분 짓는 변경 가능성의 대상은 **변수 영역** 메모리이다. 
- 한 번 데이터 할당이 이뤄진 변수 공간에 다른 데이터를 재할당할 수 있는지 여부가 관건이다. 
- 불변성 여부를 구분할 때의 변경 가능성의 대상은 **데이터 영역** 메모리이다. 
- 기본형 데이터인 숫자, 문자열, boolean, null, undefined, Symbol은 모두 **불변값**이다. 

<br>

- 기존에 저장했던 데이터를 찾아서 있으면 재활용하고, 없으면 새로 만들어서 저장한다. 
- 한 번 만든 값을 바꿀 수 없고, 숫자 값도 다른 값으로 변경할 수 없다. 
- 변경은 새로 만드는 동작을 통해서만 이뤄진다. 이것이 바로 불변값의 성질
- 한 번 만들어진 값은 가비지 컬렉팅을 당하지 않는 한 영원히 변하지 않는다. 

### 4-2 가변값
- 기본형 데이터와의 차이는 **'객체의 변수(프로퍼티) 영역'**이 별도로 존재한다는 점
- 객체가 별도로 할애한 영역은 변수 영역일 뿐 **'데이터 영역'**은 기존의 메모리 공간을 그대로 활용하고 있다. 
- 데이터 영역에 저장된 값은 모두 불변값이다. 
  - 그러나 변수에는 다른 값을 얼마든지 대입할 수 있다. 
  - 이 부분 때문에 참조형 데이터는 **불변하지 않다(가변값이다)**라고 한다. 

- **'새로운 객체'**가 만들어진 것이 아니라 기존의 객체 내부의 값만 바뀐 것
- 참조형 데이터의 프로퍼티에 다시 참조형 데이터를 할당하는 경우 : 중첩 객체

<br>

- 참조 카운트: 어떤 데이터에 대해 자신의 주소를 참조하는 변수의 개수
- 참조 카운트가 0인 메모리 주소는 가비지 컬렉터의 수거 대상이 된다. 
- 가비지 컬렉터는 런타임 환경에 따라 특정 시점이나 메모리 사용량이 포화 상태에 임박할 때마다 자동으로 수거 대상들을 수거한다. 
- 수거된 메모리는 다시 새로운 값을 할당할 수 있는 빈 공간이 된다. 

<br>

***

<br>

### 4-3 변수 복사 비교

- 변수를 복사하는 과정은 기본형 데이터와 참조형 데이터 모두 같은 주소를 바라보게 되는 점에서 동일하다. 
- 복사 과정은 동일하지만 데이터 할당 과정에서 이미 차이가 있기 때문에 변수 복사 이후의 동작에도 큰 차이가 발생한다. 

- 어떤 데이터 타입이든 변수에 할당하기 위해서는 주솟값을 복사해야 하기 때문에, 엄밀히 따지면 자바스크립트의 모든 데이터 타입은 참조형 데이터일 수밖에 없다. 

## 05 불변 객체 
### 5-1 불변 객체를 만드는 간단한 방법
- 참조형 데이터의 '가변'은 데이터 자체가 아닌 내부 프로퍼티를 변경할 때만 성립한다. 
- 데이터 자체를 변경하고자 하면(새로운 데이터를 할당하고자 하면) 기본형 데이터와 마찬가지로 **기존 데이터는 변하지 않는다.**
- 내부 프로퍼티를 변경할 필요가 있을 때마다 매번 새로운 객체를 만들어 재할당하기로 규칙을 정하거나 자동으로 새로운 객체를 만드는 도구를 활용한다면 객체 역시 불변성을 확보할 수 있을 것이다. 
- 값으로 전달받은 객체에 변경을 가하더라도 원본 객체는 변하지 않아야 하는 경우 불변 객체가 필요하다. 
- 대상 객체의 프로퍼티 개수에 상관 없이 모든 프로퍼티를 복사하는 함수를 만드는 것이 좋다. 

<br>

### 5-2 얕은 복사와 깊은 복사 
- 얕은 복사(shallow copy) 는 바로 아래 단계의 값만 복사하는 방법
  - 중접된 객체에서 참조형 데이터가 저장된 프로퍼티를 복사할 때 그 주솟값만 복사한다는 의미
  - 해당 프로퍼티에 대해 원본과 사본이 모두 동일한 참조형 데이터의 주소를 가리키게 된다.
  - 사본을 바꾸면 원본도 바뀌고, 원본을 바꾸면 사본도 바뀐다.
- 깊은 복사(deep copy)는 내부의 모든 값들을 하나하나 찾아서 전부 복사하는 방법

<br>

- 어떤 객체를 복사할 때 객체 내부의 모든 값을 복사해서 완전히 새로운 데이터를 만들고자 할 때, 객체의 프로퍼티 중에서 그 값이 **기본형 데이터일 경우에는 그대로 복사**하면 되지만 **참조형 데이터는 다시 그 내부의 프로퍼티들을 복사**해야 한다. 

## 06 undefined와 null

- `undefined`는 사용자가 명시적으로 지정할 수도 있지만 값이 존재하지 않을 때 자바스크립트 엔진이 자동으로 부여하는 경우도 있다. 
  1. 값을 대입하지 않은 변수, 즉 데이터 영역의 메모리 주소를 지정하지 않은 식별자에 접근할 때
  2. 객체 내부의 존재하지 않는 프로퍼티에 접근하려고 할 때
  3. return 문이 없거나 호출되지 않는 함수의 실행 결과 

- `비어있는 요소`와 `undefiend를 할당한 요소`는 다르다
- `비어있는 요소`는 순회와 관련된 많은 배열 메서드들의 순회 대상에서 제외된다. 

<br>

- 값이 지정되지 않은 인덱스는 '아직은 존재하지 않는 프로퍼티'에 지나지 않는다. 
- 명시적으로 부여한 경우 (`undefiend` 그 자체로 값) 
- undefiend가 비록 '비어있음'을 의미하긴 하지만 하나의 값으로 동작하기 때문에 이때의 프로퍼티나 배열의 요소는 고유의 키값(프로퍼티 이름)이 실존하게 되고, 따라서 순회의 대상이 될 수 있다. 
- 사용자가 아무것도 하지 않은 채로 접근했을 때 자바스크립트 엔진이 하는 수 없이 반환해주는 `indefined`는 해당 프로퍼티 내지 배열의 키값(인덱스) 자체가 존재하지 않음을 의미 
- 값으로써 어딘가에 할당된 `undefiend`는 **실존하는 데이터**인 반면, 자바스크립트 엔진이 반환해주는 undefiend는 문자 그대로 **값이 없음을 나타내는 것**
- **직접 `undefiend`를 할당하지 않아야한다.** 
  - '비어있음'을 명시적으로 나타내고 싶을 때는 **null**을 쓰면 된다. 

<br>

- **null**은 한 가지 주의할 점이 있다. 
  - `typeof null`이 `object`라는 점

- 어떤 변수가 실제로 null 인지 아니면 undefined인지는 `===`를 써야만 정확히 판별 가능하다. 

<br>

***

<br>

## 07 정리

- 자바스크립트 데이터 타입에는 크게 기본형과 참조형이 있다. 
- 기본적으로 기본형은 불변값이고 참조형은 가변값이다. 
    - 불변 객체는 원본 객체가 변하지 않아야 하는 경우에 필요하다.
    - 한 번 만든 값은 가비지 컬렉팅을 당하지 않는 한 영원히 변하지 않는다. 이것이 불변이다. 
- **변수**는 변경 가능한 데이터가 담길 수 있는 공간이고, **식별자**는 그 변수의 이름을 말한다. 
- 메모리의 빈 공간에 식별자를 저장하고, 그 공간에 자동으로 `undefined`를 할당한다. 
- 별도의 공간에 데이터를 저장하고, 그 공간의 주소를 변수의 값 영역에 할당한다. 
- 참조형 데이터는 여러 개의 프로퍼티(변수)를 모은 **그룹**이다. 
- `undefined`는 어떤 변수에 값이 존재하지 않을 경우
- `null`은 사용자가 명시적으로 **없음**을 표현하기 위해 대입한 값이다. 
    - 본래의 의미에 따라 사용자가 없음을 표현하기 위해 `undefined`보다 `null`을 사용하자

